{"ast":null,"code":"import { userConstants } from \"./constants\";\nimport { firestore } from 'firebase';\nexport const getRealtimeUsers = uid => {\n  //console.log('uid', uid)\n  return async dispatch => {\n    dispatch({\n      type: `${userConstants.GET_REALTIME_USERS}_REQUEST`\n    });\n    const db = firestore();\n    const unsubscribe = db.collection(\"users\") //we can add users in firebase database \n    .onSnapshot(querySnapshot => {\n      const users = [];\n      querySnapshot.forEach(function (doc) {\n        if (doc.data().uid != uid) {\n          users.push(doc.data());\n        }\n      }); //if any user uid does not equal to uid than than that user has to add valid data \n      // elseif the user has uid equal to the uid provided than user is successed and can chat with other user\n\n      dispatch({\n        type: `${userConstants.GET_REALTIME_USERS}_SUCCESS`,\n        payload: {\n          users\n        }\n      });\n    });\n    return unsubscribe;\n  };\n};\nexport const updateMessage = msgObj => {\n  return async dispatch => {\n    const db = firestore();\n    db.collection('conversations').add({ ...msgObj,\n      isView: false,\n      createdAt: new Date()\n    }).then(data => {\n      console.log(data); //If the conversation is done successfully \n      // else it would display an error \n    }).catch(error => {\n      console.log(error);\n    });\n  };\n};\nexport const getRealtimeConversations = user => {\n  return async dispatch => {\n    const db = firestore();\n    db.collection('conversations').where('user_uid_1', 'in', [user.uid_1, user.uid_2]).orderBy('createdAt', 'asc').onSnapshot(querySnapshot => {\n      const conversations = [];\n      querySnapshot.forEach(doc => {\n        if (doc.data().user_uid_1 == user.uid_1 && doc.data().user_uid_2 == user.uid_2 || doc.data().user_uid_1 == user.uid_2 && doc.data().user_uid_2 == user.uid_1) {\n          conversations.push(doc.data());\n        } // if(conversations.length > 0){\n        // }else{\n        //     dispatch({\n        //         type: `${userConstants.GET_REALTIME_MESSAGES}_FAILURE`,\n        //         payload: { conversations }\n        //     })\n        // }\n\n      });\n      dispatch({\n        type: userConstants.GET_REALTIME_MESSAGES,\n        payload: {\n          conversations\n        }\n      });\n      console.log(conversations);\n    }); //user_uid_1 == 'myid' and user_uid_2 = 'yourId' OR user_uid_1 = 'yourId' and user_uid_2 = 'myId'\n  };\n};","map":{"version":3,"sources":["C:/Users/nisht/Downloads/reactjs-firestore-messenger-master/reactjs-firestore-messenger-master/src/actions/user.actions.js"],"names":["userConstants","firestore","getRealtimeUsers","uid","dispatch","type","GET_REALTIME_USERS","db","unsubscribe","collection","onSnapshot","querySnapshot","users","forEach","doc","data","push","payload","updateMessage","msgObj","add","isView","createdAt","Date","then","console","log","catch","error","getRealtimeConversations","user","where","uid_1","uid_2","orderBy","conversations","user_uid_1","user_uid_2","GET_REALTIME_MESSAGES"],"mappings":"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","sourcesContent":["import { userConstants } from \"./constants\";\nimport { firestore } from 'firebase';\n\nexport const getRealtimeUsers = (uid) => {\n\n    //console.log('uid', uid)\n\n    return async (dispatch) => {\n\n        dispatch({ type: `${userConstants.GET_REALTIME_USERS}_REQUEST` });\n\n        const db = firestore();\n        const unsubscribe = db.collection(\"users\")\n        //we can add users in firebase database \n        \n        .onSnapshot((querySnapshot) => {\n            const users = [];\n            querySnapshot.forEach(function(doc) {\n                if(doc.data().uid != uid){\n                    users.push(doc.data());\n                }\n            });\n            //if any user uid does not equal to uid than than that user has to add valid data \n            // elseif the user has uid equal to the uid provided than user is successed and can chat with other user\n\n            dispatch({ \n                type: `${userConstants.GET_REALTIME_USERS}_SUCCESS`,\n                payload: { users }\n            });\n\n        });\n\n        return unsubscribe;\n\n    }\n\n}\n\nexport const updateMessage = (msgObj) => {\n    return async dispatch => {\n\n        const db = firestore();\n        db.collection('conversations')\n        .add({\n            ...msgObj,\n            isView: false,\n            createdAt: new Date()\n        })\n        .then((data) => {\n            console.log(data)\n            //If the conversation is done successfully \n            // else it would display an error \n\n\n        })\n        .catch(error => {\n            console.log(error)\n        });\n\n    }\n}\n\nexport const getRealtimeConversations = (user) => {\n    return async dispatch => {\n\n        const db = firestore();\n        db.collection('conversations')\n        .where('user_uid_1', 'in', [user.uid_1, user.uid_2])\n        .orderBy('createdAt', 'asc')\n        .onSnapshot((querySnapshot) => {\n\n            const conversations = [];\n\n            querySnapshot.forEach(doc => {\n\n                if(\n                    (doc.data().user_uid_1 == user.uid_1 && doc.data().user_uid_2 == user.uid_2)\n                    || \n                    (doc.data().user_uid_1 == user.uid_2 && doc.data().user_uid_2 == user.uid_1)\n                ){\n                    conversations.push(doc.data())\n                }\n\n                \n\n                // if(conversations.length > 0){\n                    \n                // }else{\n                //     dispatch({\n                //         type: `${userConstants.GET_REALTIME_MESSAGES}_FAILURE`,\n                //         payload: { conversations }\n                //     })\n                // }\n\n\n\n                \n            });\n\n            dispatch({\n                type: userConstants.GET_REALTIME_MESSAGES,\n                payload: { conversations }\n            })\n\n            console.log(conversations);\n        })\n        //user_uid_1 == 'myid' and user_uid_2 = 'yourId' OR user_uid_1 = 'yourId' and user_uid_2 = 'myId'\n\n\n    }\n}"]},"metadata":{},"sourceType":"module"}